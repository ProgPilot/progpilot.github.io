

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    
    <!-- This is fancy favicon stuff. It uses files generated by https://realfavicongenerator.net but these are stored in another repository.-->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="theme-color" content="#ffffff">

    <style>

        @import url("https://fonts.googleapis.com/css?family=Lato:400,400italic,700,700italic");

        .leftpad {
            padding-left: 5px;
        }

        .image-background {
            background-image: url("https://www.progpilot.com/writeups/resources/banner.jpg");
            background-size: cover;
        }

        .header {
            font-family: 'Roboto Mono', monospace;
            color: white;
        }

        .white {
            color: white;
        }

        .whitelink, .whitelink:hover, .whitelink:active, .whitelink:visited {
            color: white;
        }

        .breadcrumb {
            margin-bottom: unset;
            background-color: unset;
            border-radius: unset;
        }

        .breadcrumb-item + .breadcrumb-item::before {
            display: inline-block;
            padding-right: 0.5rem;
            color: white;
            content: ">";
        }

        body {
            font-family: "Lato", sans-serif;
        }

        .navbar a:hover {
            text-decoration: none;
        }

        .p-3 {
            padding: $spacer !important;
        }

    </style>

    
        
    

    <title>No Sleep | ProgPilot writeups</title>

    <meta name="description" content="Writeup by the CTF team ProgPilot for No Sleep (Riceteacatpanda 2020)">

    <meta property="og:title" content="No Sleep">

<meta property="og:site_name" content="progpilot.com">
<meta property="og:description" content="Writeup by the CTF team ProgPilot for No Sleep (Riceteacatpanda 2020)">
<meta property="og:url" content="https://www.progpilot.com/writeups/rtcp2020/nosleep">
<meta property="og:image" content="https://www.progpilot.com/writeups/resources/progpilot.jpg">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-166229733-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-166229733-1');
</script>

    

    <style>
    .videoWrapper {
    	position: relative;
    	padding-bottom: 56.25%; /* 16:9 */
    	padding-top: 25px;
    	height: 0;
    }
    .videoWrapper iframe {
    	position: absolute;
    	top: 0;
    	left: 0;
    	width: 100%;
    	height: 100%;
    }

	img {
		max-width: 100%;
		height: auto;
		display: block;
		margin-left: auto;
		margin-right: auto;
		border-style: solid;
		border-width: 1px;
	}
    </style>


</head>
<body>

    <nav class="navbar navbar-expand-lg image-background white">
    <div class="navbar-brand">
        <a class="header whitelink" href="https://www.progpilot.com/writeups/">ProgPilot writeups</a>
    </div>

    <div class="collapse navbar-collapse">
        <div class="navbar-nav mr-auto">
            <ol class="breadcrumb">
                
                
                <li class="breadcrumb-item"><a class="whitelink" href="https://www.progpilot.com/writeups/">Home</a></li>
                
                
                
                <li class="breadcrumb-item"><a class="whitelink" href="../">Riceteacatpanda 2020</a></li>
                
                
                
                <li class="breadcrumb-item" aria-current="page">No Sleep</li>
                
                
            </ol>
        </div>

        
    </div>

</nav>

    <div class="container">

        <div class="p-3"></div>

        

    <h4>Writeup for <b>No Sleep</b></h4>
    <p>Category: Web<br>Author: Tom<br>

        

    </p>

    <p>No Sleep had a simple description and a webpage that had a countdown timer and a message saying that we'd be allowed to be "real gamers" when the timer ended (at some point after the CTF had ended).</p>
<p><img src="https://cdn.tdpain.net/ctf-writeups/rtcp2020/nosleep/page.png" alt="page"></p>
<p>If we take a look at the Javascript source in the browser, we see a large block of obfuscated nonsense, so the first thing to do was to stick it in a beatufier and go from there, right? Wrong.
What the beatifier did was remove an array from the beginning of the Javascript, so I spent some time trying to figure out what was going on until I realised that there was part of the script missing.</p>
<p><img src="https://cdn.tdpain.net/ctf-writeups/rtcp2020/nosleep/js.png" alt="js"></p>
<p>After manually expanding the code out of it's minified state, we were able to see a bit more into its workings.
Two things became apparent:</p>
<ul>
<li>There was a large array that contained various different strings, that had seemingly no relevance to anything whatsoever.</li>
<li>There was a short function that was referenced frequently throughout the rest of the code</li>
</ul>
<p>When we look at this in more depth, we can see our short function is pulling elements from the array based on arguments supplied to it. Using this, we can see that a lot of the function calls to things like <code>Math.floor</code> or <code>element.innerHTML</code> are done by passing an element from the list as opposed to just typing it out further in an attempt to obfuscate the code.
At the very bottom of the code there was an <code>if</code> statement. By copy pasting the contents of that statement into the Javascript console on the page with the countdown, the flag is returned in the console and the flag is also written to the screen.</p>
<p><img src="https://cdn.tdpain.net/ctf-writeups/rtcp2020/nosleep/flag.png" alt="flag"></p>
<p>You can see the code for this challenge <a href="https://github.com/codemicro/ctf-writeups/tree/master/rtcp2020/nosleep">here</a>.</p>
<p><img src="https://cdn.tdpain.net/ctf-writeups/rtcp2020/nosleep/chall.png" alt="chall"></p>




        <div class="p-3"></div>

        <footer style="font-size: 0.8em;">
    Site last updated on Mon, 13 July @ 10:58AM<br>
    Content copyright &copy; <script>document.write(new Date().getFullYear())</script> ProgPilot
</footer>
<br>

    </div>
</body>
</html>